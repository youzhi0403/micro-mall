<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.youzhi.dao.GoodDao">
    <resultMap id="goodResultResultMap" type="com.youzhi.dto.GoodVo" extends="com.youzhi.mapper.GoodMapper.BaseResultMap">
        <collection property="classificationList" resultMap="com.youzhi.mapper.ClassificationMapper.BaseResultMap" columnPrefix="classification_">
        </collection>
    </resultMap>

    <select id="list" resultMap="goodResultResultMap">
        select g.*,cla.*
        from
          good g
          left join good_classification_relation gcr on gcr.good_id = g.id
          left join classification cla on cla.id = gcr.classification_id
        where
          g.delete_status = 0
          <if test="queryParam.keyword != null and queryParam.keyword != ''">
            and g.name like %#{queryParam.keyword}%
          </if>
          <if test="queryParam.status != null">
            and g.status = #{queryParam.status}
          </if>
          <if test="queryParam.classificationId != null">
            and cla.id = #{queryParam.classificationId}
          </if>
        order by g.create_time desc
    </select>

    <insert id="addBatch" parameterType="java.util.List" useGeneratedKeys="true">
        insert into good
        (name,full_name,imgs,price,sales,good_function,manufacturer,good_number,good_type,approval_number,specification,good_usage,common_name,untoward_effect,taboo,inventory,create_time,update_time,create_user_id,update_user_id,status,delete_status)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (
              #{item.name},
              #{item.fullName},
              #{item.imgs},
              #{item.price},
              #{item.sales},
              #{item.goodFunction},
              #{item.manufacturer},
              #{item.goodNumber},
              #{item.goodType},
              #{item.approvalNumber},
              #{item.specification},
              #{item.goodUsage},
              #{item.commonName},
              #{item.untowardEffect},
              #{item.taboo},
              #{item.inventory},
              #{item.createTime},
              #{item.updateTime},
              #{item.createAdminId},
              #{item.updateAdminId},
              #{item.status},
              #{item.deleteStatus}
            )
        </foreach>
    </insert>


</mapper>